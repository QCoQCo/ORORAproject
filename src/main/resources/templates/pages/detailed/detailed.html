<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/layout}" lang="ko">
    <head>
        <title layout:fragment="title">부산 관광지 상세정보</title>
        <th:block layout:fragment="css">
            <link rel="stylesheet" th:href="@{/css/detailPage.css}" />
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
        </th:block>
    </head>
    <body>
        <div layout:fragment="content">

        <!-- Back Button -->
        <div class="back-button-container">
            <a href="javascript:history.back()" class="back-button"> 이전 페이지로 돌아가기 </a>
        </div>

        <div id="Wrapper" th:data-kakao-api-key="${kakaoMapApiKey}">
            <div class="inner">
                <div class="title">
                    <h2 id="spot-title">관광지명</h2>
                    <p class="local" id="spot-location">부산 지역구</p>
                    <p class="descript" id="spot-description">관광지 설명</p>
                </div>
                <div class="middleButtons">
                    <div class="left">
                        <div class="like">
                            <p class="likeBtn"></p>
                            <p class="likeCount">0</p>
                        </div>
                        <div class="eyes">
                            <p class="eyesPho"></p>
                            <p class="eyesCount">0</p>
                        </div>
                        <div class="review-info" id="review-info">
                            <p class="reviewIcon">⭐</p>
                            <div class="review-info-text">
                                <p class="review-average">평점 없음</p>
                                <p class="review-total">리뷰 <span id="review-total-count">0</span>개</p>
                            </div>
                        </div>
                    </div>
                    <div class="right">
                        <div class="print">
                            <p class="printPho"></p>
                        </div>
                        <div class="share">
                            <p class="sharePho"></p>
                        </div>
                    </div>
                </div>

                <div class="tap">
                    <ul id="subTitle">
                        <li id="photo" class="section">사진보기</li>
                        <li id="detail" class="section">상세정보</li>
                        <li id="location" class="section">위치</li>
                        <li id="comment" class="section">리뷰</li>
                    </ul>
                </div>
                <div class="subPic">
                    <button class="submitPicture"><span></span>사진등록신청</button>
                </div>

                <div class="photo sectionList">
                    <div
                        style="--swiper-navigation-color: #fff; --swiper-pagination-color: #fff"
                        class="swiper mySwiper2"
                    >
                        <div class="swiper-wrapper" id="main-slider">
                            <!-- 메인 이미지들이 동적으로 추가됩니다 -->
                        </div>
                        <div class="swiper-button-next"></div>
                        <div class="swiper-button-prev"></div>
                    </div>
                    <div thumbsSlider="" class="swiper mySwiper">
                        <div class="swiper-wrapper" id="thumb-slider">
                            <!-- 썸네일 이미지들이 동적으로 추가됩니다 -->
                        </div>
                    </div>
                </div>

                <div class="detail sectionList">
                    <h3>상세정보</h3>
                    <button class="detailPicture"><span></span>관광지 정보 수정요청</button>
                </div>

                <div class="detailScript">
                    <p id="detailed-description">상세 설명이 여기에 표시됩니다.</p>
                </div>

                <div id="map-container" class="sectionList">
                    <h3>위치 정보</h3>
                    <div id="kakao-map" style="width: 100%; height: 400px; margin: 20px 0"></div>
                </div>

                <div class="aboutAhop" id="spot-info">
                    <!-- 관광지 정보가 동적으로 추가됩니다 -->
                </div>

                <div class="tag" id="hashtags">
                    <!-- 해시태그들이 동적으로 추가됩니다 -->
                </div>

                <div class="goodBad">
                    <div class="left">
                        <strong class="goodBadTitle">해당 여행지가 마음에 드시나요?</strong>
                        <p class="goodBadscr">
                            평가를 해주시면 개인화 추천 시 활용하여 최적의 여행지를 추천해
                            드리겠습니다.
                        </p>
                    </div>
                    <div class="right">
                        <button class="good">
                            <span class="likeIco"></span>
                            <span>좋아요!</span>
                        </button>
                        <button class="bad">
                            <span class="dislikeIco"></span>
                            <span>별로예요</span>
                        </button>
                    </div>
                </div>

                <!-- 비슷한 관광지 추천 섹션 -->
                <div class="similar-spots-section" id="similar-spots-section" style="display: none;">
                    <div class="similar-spots-header">
                        <h3>🎯 비슷한 관광지 추천</h3>
                        <p class="similar-spots-desc">이 관광지와 비슷한 태그를 가진 관광지들이에요!</p>
                    </div>
                    <div class="similar-spots-container" id="similar-spots-container">
                        <!-- 비슷한 관광지 카드들이 동적으로 추가됩니다 -->
                    </div>
                </div>

                <div class="comment sectionList">
                    <div class="commentTitle">
                        <h3>리뷰</h3>
                        <p>(<span id="review-count">0</span>)</p>
                    </div>

                    <!-- 리뷰 작성 폼 -->
                    <div class="reviewWriteForm">
                        <div class="reviewFormTop">
                            <input
                                type="text"
                                id="review-title"
                                placeholder="리뷰 제목을 입력해주세요"
                                maxlength="50"
                            />
                            <div class="rating-input">
                                <span>별점:</span>
                                <div class="stars">
                                    <button type="button" class="star" data-rating="1">★</button>
                                    <button type="button" class="star" data-rating="2">★</button>
                                    <button type="button" class="star" data-rating="3">★</button>
                                    <button type="button" class="star" data-rating="4">★</button>
                                    <button type="button" class="star" data-rating="5">★</button>
                                </div>
                                <span class="rating-text">별점을 선택해주세요</span>
                            </div>
                        </div>
                        <textarea
                            placeholder="이 관광지에 대한 후기를 작성해주세요. (최대 1000자)"
                            id="review-content"
                            name="review-content"
                            maxlength="1000"
                        ></textarea>
                        <!-- 이미지 미리보기 영역 -->
                        <div id="review-images-preview" class="review-images-preview" style="display: none;">
                            <div class="review-images-header">
                                <span class="review-images-count">사진 <span id="review-images-count">0</span>장</span>
                                <button type="button" class="remove-all-images" id="remove-all-images">전체 삭제</button>
                            </div>
                            <div id="review-images-container" class="review-images-container">
                                <!-- 이미지 미리보기들이 동적으로 추가됩니다 -->
                            </div>
                        </div>
                        <input type="file" id="review-image-input" accept="image/*" multiple style="display: none;" />
                        <div class="reviewFormBottom">
                            <div class="reviewFormInfo">
                                <span class="char-count"><span id="char-count">0</span>/1000</span>
                            </div>
                            <div class="commentPicture">
                                <button type="button" class="pho" id="review-photo-btn"><span></span>사진</button>
                                <button class="sub" id="submit-review" disabled>리뷰 등록</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="userPhotoCo">
                    <div class="up">
                        <h3>포토 리뷰</h3>
                        <p id="view-all-photos" class="view-toggle">전체보기</p>
                    </div>
                    <div class="usercheck">
                        <ul>
                            <li><button class="sort-btn active" data-sort="latest">최신순</button></li>
                            <li><button class="sort-btn" data-sort="popular">추천순</button></li>
                        </ul>
                    </div>
                    <!-- 포토리뷰 리스트 형태 (기본) -->
                    <div id="photo-reviews-list" class="photo-reviews-list">
                        <!-- 포토리뷰들이 동적으로 추가됩니다 -->
                    </div>
                    <!-- 포토리뷰 그리드 형태 (전체보기 클릭 시) -->
                    <div id="photo-reviews-grid" class="photo-reviews-grid" style="display: none;">
                        <!-- 포토리뷰들이 동적으로 추가됩니다 -->
                    </div>
                </div>

                <!-- 리뷰 목록 컨테이너 -->
                <div id="reviews-container">
                    <!-- 리뷰들이 동적으로 추가됩니다 -->
                </div>

                <!-- 리뷰가 없을 때 표시되는 메시지 -->
                <div id="no-reviews-message" class="no-reviews" style="display: none">
                    <p>아직 작성된 리뷰가 없습니다. 첫 번째 리뷰를 작성해보세요!</p>
                </div>
            </div>
        </div>

        <!-- 사진 등록 신청 모달 -->
        <div class="modal" id="photo-request-modal">
            <div class="modal-content">
                <span class="close" id="close-photo-request-modal">&times;</span>
                <h2>사진 등록 신청</h2>
                <form id="photo-request-form">
                    <input type="hidden" id="photo-request-spot-id" />
                    <div class="form-group">
                        <label for="photo-request-spot-name">관광지명</label>
                        <input type="text" id="photo-request-spot-name" readonly />
                    </div>

                    <div class="form-group">
                        <label for="photo-request-image">사진 업로드</label>
                        <input type="file" id="photo-request-image" accept="image/*" required />
                        <div class="image-preview-container" id="photo-preview-container" style="display: none;">
                            <img id="photo-preview" src="" alt="미리보기" style="max-width: 100%; max-height: 300px; margin-top: 10px;" />
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="photo-request-description">사진 설명</label>
                        <textarea 
                            id="photo-request-description" 
                            rows="4" 
                            placeholder="사진에 대한 설명을 입력해주세요. (선택사항)"
                            maxlength="500"
                        ></textarea>
                        <span class="char-count"><span id="photo-description-char-count">0</span>/500</span>
                    </div>

                    <button type="submit" class="submit-btn">신청 제출</button>
                </form>
            </div>
        </div>

        <!-- 관광지 정보 수정요청 모달 -->
        <div class="modal" id="spot-edit-request-modal">
            <div class="modal-content">
                <span class="close" id="close-spot-edit-request-modal">&times;</span>
                <h2>관광지 정보 수정요청</h2>
                <form id="spot-edit-request-form">
                    <input type="hidden" id="spot-edit-request-spot-id" />
                    <div class="form-group">
                        <label for="spot-edit-request-spot-name">관광지명</label>
                        <input type="text" id="spot-edit-request-spot-name" readonly />
                    </div>

                    <div class="form-group">
                        <label for="spot-edit-request-content">수정 요청 내용 <span class="required">*</span></label>
                        <textarea 
                            id="spot-edit-request-content" 
                            rows="6" 
                            placeholder="수정하고 싶은 내용을 자세히 입력해주세요. (예: 관광지 설명이 부정확합니다, 주소가 변경되었습니다 등)"
                            maxlength="1000"
                            required
                        ></textarea>
                        <span class="char-count"><span id="spot-edit-content-char-count">0</span>/1000</span>
                    </div>

                    <div class="form-group">
                        <label for="spot-edit-request-image">참고 사진 (선택사항)</label>
                        <input type="file" id="spot-edit-request-image" accept="image/*" />
                        <small class="form-hint">수정 요청과 관련된 참고 사진을 첨부할 수 있습니다</small>
                        <div class="image-preview-container" id="spot-edit-preview-container" style="display: none;">
                            <img id="spot-edit-preview" src="" alt="미리보기" style="max-width: 100%; max-height: 300px; margin-top: 10px; border-radius: 8px; border: 2px solid #e0e0e0;" />
                        </div>
                    </div>

                    <button type="submit" class="submit-btn">수정요청 제출</button>
                </form>
            </div>
        </div>

        <!-- 포토리뷰 상세 모달 -->
        <div class="modal" id="photo-review-modal">
            <div class="modal-content photo-review-modal-content">
                <span class="close" id="close-photo-review-modal">&times;</span>
                <div id="photo-review-modal-content">
                    <!-- 포토리뷰 상세 내용이 동적으로 추가됩니다 -->
                </div>
            </div>
        </div>

        <!-- 신고 모달 -->
        <div class="modal" id="report-modal">
            <div class="modal-content report-modal-content">
                <span class="close" id="close-report-modal">&times;</span>
                <h2 id="report-modal-title">신고하기</h2>
                <form id="report-form">
                    <input type="hidden" id="report-target-id" />
                    <input type="hidden" id="report-target-type" />
                    <div class="form-group">
                        <label>신고 사유 <span class="required">*</span></label>
                        <div class="report-reason-options">
                            <label class="report-reason-option">
                                <input type="radio" name="report-reason" value="spam" required />
                                <span>스팸</span>
                            </label>
                            <label class="report-reason-option">
                                <input type="radio" name="report-reason" value="abuse" required />
                                <span>욕설/비방</span>
                            </label>
                            <label class="report-reason-option">
                                <input type="radio" name="report-reason" value="inappropriate" required />
                                <span>부적절한 내용</span>
                            </label>
                            <label class="report-reason-option">
                                <input type="radio" name="report-reason" value="other" required />
                                <span>기타</span>
                            </label>
                        </div>
                    </div>
                    <div class="form-group" id="report-other-reason-group" style="display: none;">
                        <label for="report-other-reason">상세 사유 <span class="required">*</span></label>
                        <textarea 
                            id="report-other-reason" 
                            rows="4" 
                            placeholder="신고 사유를 자세히 입력해주세요."
                            maxlength="500"
                        ></textarea>
                        <span class="char-count"><span id="report-reason-char-count">0</span>/500</span>
                    </div>
                    <div class="form-group">
                        <p class="report-notice">
                            ⚠️ 허위 신고는 제재를 받을 수 있습니다. 신중하게 신고해주세요.
                        </p>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="cancel-btn" id="cancel-report-btn">취소</button>
                        <button type="submit" class="submit-btn">신고하기</button>
                    </div>
                </form>
            </div>
        </div>

        <th:block layout:fragment="script">
            <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
            <script th:src="@{/js/detailPage.js}"></script>
        </th:block>
    </body>
</html>
